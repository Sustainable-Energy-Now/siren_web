<!-- home.html - Complete enhanced template -->
{% extends 'base.html' %}
{% load static %}

{% block content %}
    <h2>Welcome to Siren Web!</h2>
    <p>This is a web interface to Siren, an open source python app for modelling renewable energy for the South West Interconnected system (SWIS).
    The Siren system architecture is illustrated below. Click on a component to see further information.</p>

    <!-- Settings Display -->
    <div class="settings-box">
        <strong>Demand Year: </strong>{{ demand_year|default:"Not set" }}<br>
        <strong>Scenario: </strong>{{ scenario|default:"Not set" }}<br>
        <strong>Config: </strong>{{ config_file|default:"default.ini" }}
    </div>

    <!-- System Diagram Container -->
    <div id="system-diagram-container">
        <svg id="system-diagram" width="100%" height="600" viewBox="0 0 800 600">
            <!-- Arrow marker definition -->
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                        refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
                </marker>
                
                <!-- Gradient definitions for different component types -->
                <linearGradient id="modelGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#dce6f2;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#dce6f2;stop-opacity:1" />
                </linearGradient>
                
                <linearGradient id="moduleGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#739fd0;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#739fd0;stop-opacity:1" />
                </linearGradient>
                
                <linearGradient id="externalGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#4aacc5;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#4aacc5;stop-opacity:1" />
                </linearGradient>
            </defs>
            
            <!-- Groups for organized rendering -->
            <g id="connections-group"></g>
            <g id="components-group"></g>
        </svg>
        
        <!-- Loading indicator -->
        <div id="diagram-loading" class="loading-overlay">
            <div class="spinner"></div>
            <p>Loading system diagram...</p>
        </div>
        
        <!-- Error message -->
        <div id="diagram-error" class="error-overlay" style="display: none;">
            <p>Error loading system diagram. Please refresh the page.</p>
        </div>
    </div>

    <!-- Component Details Modal -->
    <div class="modal fade" id="componentModal" tabindex="-1" aria-labelledby="componentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="componentModalLabel">Component Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Component Information -->
                    <div id="component-info">
                        <h6 id="component-name" class="component-title"></h6>
                        <p id="component-description" class="component-description"></p>
                        <div class="component-badges">
                            <span id="component-type" class="badge bg-secondary"></span>
                            <span id="component-status" class="badge bg-success" style="display: none;">Active</span>
                        </div>
                    </div>
                    
                    <!-- Connection Information -->
                    <div id="component-connections" style="display: none;">
                        <h6>Connections:</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <strong>Incoming:</strong>
                                <ul id="incoming-connections" class="connection-list"></ul>
                            </div>
                            <div class="col-md-6">
                                <strong>Outgoing:</strong>
                                <ul id="outgoing-connections" class="connection-list"></ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sample Data Table -->
                    <div id="component-data" style="display: none;">
                        <h6>Sample Data:</h6>
                        <div class="table-responsive">
                            <table class="table table-striped table-sm" id="component-table">
                                <thead id="table-header"></thead>
                                <tbody id="table-body"></tbody>
                            </table>
                        </div>
                        <p class="text-muted small">Showing up to 5 sample records</p>
                    </div>
                    
                    <!-- Model Information -->
                    <div id="model-info" style="display: none;">
                        <h6>Model Information:</h6>
                        <div id="model-details"></div>
                    </div>
                    
                    <!-- Loading Indicator -->
                    <div id="loading-indicator" class="text-center">
                        <div class="spinner-border spinner-border-sm" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <span class="ms-2">Loading component data...</span>
                    </div>
                    
                    <!-- Error Message -->
                    <div id="error-message" class="alert alert-danger" style="display: none;">
                        <strong>Error:</strong> <span id="error-text"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="refresh-component" style="display: none;">
                        Refresh Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden CSRF token for AJAX requests -->
    {% csrf_token %}

    <script>
        class SystemDiagram {
            constructor(containerId, apiEndpoint) {
                this.container = document.getElementById(containerId);
                this.apiEndpoint = apiEndpoint;
                this.components = [];
                this.connections = [];
                this.svg = document.getElementById('system-diagram');
                this.componentsGroup = document.getElementById('components-group');
                this.connectionsGroup = document.getElementById('connections-group');
                this.loadingIndicator = document.getElementById('diagram-loading');
                this.errorIndicator = document.getElementById('diagram-error');
                
                // Get CSRF token
                this.csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                
                this.init();
            }
            
            async init() {
                try {
                    this.showLoading(true);
                    await this.loadConfiguration();
                    this.renderDiagram();
                    this.attachEventHandlers();
                    this.showLoading(false);
                } catch (error) {
                    console.error('Failed to initialize system diagram:', error);
                    this.showError(true);
                    this.showLoading(false);
                }
            }
            
            showLoading(show) {
                this.loadingIndicator.style.display = show ? 'flex' : 'none';
            }
            
            showError(show) {
                this.errorIndicator.style.display = show ? 'flex' : 'none';
            }
            
            async loadConfiguration() {
                const response = await fetch(this.apiEndpoint, {
                    method: 'GET',
                    headers: {
                        'X-CSRFToken': this.csrfToken,
                        'Content-Type': 'application/json',
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                if (data.status === 'error') {
                    throw new Error(data.message);
                }
                
                this.components = data.components || [];
                this.connections = data.connections || [];
            }
            
            renderDiagram() {
                this.renderConnections();
                this.renderComponents();
                this.adjustViewBox();
            }
            
            renderComponents() {
                this.componentsGroup.innerHTML = '';
                
                this.components.forEach(component => {
                    const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                    group.setAttribute('class', 'component-group');
                    group.setAttribute('data-component', component.name);
                    group.style.cursor = 'pointer';
                    
                    // Create different shapes based on component type
                    if (component.type === 'model') {
                        // Database models represented as cylinders
                        this.createCylinder(group, component);
                    } else {
                        // Modules and external systems as rectangles
                        this.createRectangle(group, component);
                    }
                    
                    // Component text
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', component.position.x + component.position.width / 2);
                    text.setAttribute('y', component.position.y + component.position.height / 2 + 5);
                    text.setAttribute('class', 'component-text');
                    text.setAttribute('text-anchor', 'middle');
                    text.textContent = this.truncateText(component.display_name, component.position.width);
                    
                    // Component type indicator (small text)
                    const typeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    typeText.setAttribute('x', component.position.x + component.position.width / 2);
                    typeText.setAttribute('y', component.position.y + component.position.height - 8);
                    typeText.setAttribute('class', 'component-type-text');
                    typeText.setAttribute('text-anchor', 'middle');
                    typeText.textContent = component.type;
                    
                    group.appendChild(text);
                    group.appendChild(typeText);
                    this.componentsGroup.appendChild(group);
                });
            }
            
            createCylinder(group, component) {
                const x = component.position.x;
                const y = component.position.y;
                const width = component.position.width;
                const height = component.position.height;
                const ellipseHeight = height * 0.15; // Height of the ellipse (top/bottom)
                
                // Set gradient fill
                const gradientId = 'modelGradient';
                
                // Bottom ellipse (base of cylinder)
                const bottomEllipse = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
                bottomEllipse.setAttribute('cx', x + width / 2);
                bottomEllipse.setAttribute('cy', y + height - ellipseHeight);
                bottomEllipse.setAttribute('rx', width / 2);
                bottomEllipse.setAttribute('ry', ellipseHeight);
                bottomEllipse.setAttribute('class', `component-cylinder ${component.type}-component`);
                bottomEllipse.setAttribute('fill', `url(#${gradientId})`);
                
                // Side rectangle (cylinder body)
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y + ellipseHeight);
                rect.setAttribute('width', width);
                rect.setAttribute('height', height - 2 * ellipseHeight);
                rect.setAttribute('class', `component-cylinder ${component.type}-component`);
                rect.setAttribute('fill', `url(#${gradientId})`);
                
                // Top ellipse (visible part of cylinder top)
                const topEllipse = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
                topEllipse.setAttribute('cx', x + width / 2);
                topEllipse.setAttribute('cy', y + ellipseHeight);
                topEllipse.setAttribute('rx', width / 2);
                topEllipse.setAttribute('ry', ellipseHeight);
                topEllipse.setAttribute('class', `component-cylinder ${component.type}-component`);
                topEllipse.setAttribute('fill', `url(#${gradientId})`);
                
                // Add subtle stroke for definition
                [bottomEllipse, rect, topEllipse].forEach(element => {
                    element.setAttribute('stroke', '#4CAF50');
                    element.setAttribute('stroke-width', '2');
                });
                
                group.appendChild(bottomEllipse);
                group.appendChild(rect);
                group.appendChild(topEllipse);
            }
            
            createRectangle(group, component) {
                const x = component.position.x;
                const y = component.position.y;
                const width = component.position.width;
                const height = component.position.height;
                
                // Component rectangle with gradient fill
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y);
                rect.setAttribute('width', width);
                rect.setAttribute('height', height);
                rect.setAttribute('rx', 8);
                rect.setAttribute('ry', 8);
                rect.setAttribute('class', `component-box ${component.type}-component`);
                
                // Set gradient fill based on component type
                const gradientId = component.type === 'module' ? 'moduleGradient' : 'externalGradient';
                rect.setAttribute('fill', `url(#${gradientId})`);
                
                group.appendChild(rect);
            }
            
            renderConnections() {
                this.connectionsGroup.innerHTML = '';
                
                this.connections.forEach(connection => {
                    const fromComponent = this.components.find(c => c.name === connection.from);
                    const toComponent = this.components.find(c => c.name === connection.to);
                    
                    if (fromComponent && toComponent) {
                        // Calculate connection points
                        const fromX = fromComponent.position.x + fromComponent.position.width;
                        const fromY = fromComponent.position.y + fromComponent.position.height / 2;
                        const toX = toComponent.position.x;
                        const toY = toComponent.position.y + toComponent.position.height / 2;
                        
                        // Create curved path for better visual appeal
                        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        const controlPointOffset = Math.abs(toX - fromX) / 3;
                        const pathData = `M ${fromX} ${fromY} C ${fromX + controlPointOffset} ${fromY}, ${toX - controlPointOffset} ${toY}, ${toX} ${toY}`;
                        
                        path.setAttribute('d', pathData);
                        path.setAttribute('class', 'connection-line');
                        path.setAttribute('data-connection-type', connection.type);
                        path.setAttribute('marker-end', 'url(#arrowhead)');
                        
                        // Add title for hover tooltip
                        const title = document.createElementNS('http://www.w3.org/2000/svg', 'title');
                        title.textContent = `${fromComponent.display_name} → ${toComponent.display_name} (${connection.type})`;
                        path.appendChild(title);
                        
                        this.connectionsGroup.appendChild(path);
                    }
                });
            }
            
            adjustViewBox() {
                if (this.components.length === 0) return;
                
                // Calculate bounds
                let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
                
                this.components.forEach(component => {
                    const x = component.position.x;
                    const y = component.position.y;
                    const width = component.position.width;
                    const height = component.position.height;
                    
                    minX = Math.min(minX, x);
                    minY = Math.min(minY, y);
                    maxX = Math.max(maxX, x + width);
                    maxY = Math.max(maxY, y + height);
                });
                
                // Add padding
                const padding = 50;
                minX -= padding;
                minY -= padding;
                maxX += padding;
                maxY += padding;
                
                const width = maxX - minX;
                const height = maxY - minY;
                
                this.svg.setAttribute('viewBox', `${minX} ${minY} ${width} ${height}`);
            }
            
            truncateText(text, maxWidth) {
                // Simple text truncation based on character count
                const maxChars = Math.floor(maxWidth / 8); // Rough estimate
                return text.length > maxChars ? text.substring(0, maxChars - 3) + '...' : text;
            }
            
            attachEventHandlers() {
                this.componentsGroup.addEventListener('click', (event) => {
                    const componentGroup = event.target.closest('.component-group');
                    if (componentGroup) {
                        const componentName = componentGroup.getAttribute('data-component');
                        this.showComponentDetails(componentName);
                    }
                });
                
                // Add hover effects
                this.componentsGroup.addEventListener('mouseover', (event) => {
                    const componentGroup = event.target.closest('.component-group');
                    if (componentGroup) {
                        componentGroup.classList.add('component-hover');
                    }
                });
                
                this.componentsGroup.addEventListener('mouseout', (event) => {
                    const componentGroup = event.target.closest('.component-group');
                    if (componentGroup) {
                        componentGroup.classList.remove('component-hover');
                    }
                });
            }
            
            async showComponentDetails(componentName) {
                const modal = new bootstrap.Modal(document.getElementById('componentModal'));
                
                // Reset modal state
                this.resetModal();
                
                // Show modal
                modal.show();
                
                try {
                    // Try new API endpoint first
                    let response = await fetch(`{% url "component_details" "PLACEHOLDER" %}`.replace('PLACEHOLDER', componentName), {
                        headers: {
                            'X-CSRFToken': this.csrfToken,
                            'Content-Type': 'application/json',
                        }
                    });
                    
                    if (response.status === 404) {
                        // Fall back to legacy endpoint
                        response = await fetch(`{% url "home" %}?component=${componentName}`, {
                            headers: {
                                'X-CSRFToken': this.csrfToken,
                                'Content-Type': 'application/json',
                            }
                        });
                    }
                    
                    const data = await response.json();
                    
                    if (data.status === 'success') {
                        this.updateModalContent(data);
                    } else {
                        this.showModalError(data.message || 'Failed to load component data.');
                    }
                } catch (error) {
                    console.error('Error loading component details:', error);
                    this.showModalError('Error loading component data: ' + error.message);
                }
            }
            
            resetModal() {
                // Hide all sections
                document.getElementById('loading-indicator').style.display = 'block';
                document.getElementById('component-data').style.display = 'none';
                document.getElementById('component-connections').style.display = 'none';
                document.getElementById('model-info').style.display = 'none';
                document.getElementById('error-message').style.display = 'none';
                document.getElementById('refresh-component').style.display = 'none';
                
                // Clear content
                document.getElementById('component-name').textContent = '';
                document.getElementById('component-description').textContent = '';
                document.getElementById('component-type').textContent = '';
                document.getElementById('table-header').innerHTML = '';
                document.getElementById('table-body').innerHTML = '';
            }
            
            updateModalContent(data) {
                // Hide loading indicator
                document.getElementById('loading-indicator').style.display = 'none';
                
                // Update component info
                document.getElementById('component-name').textContent = data.component_name || data.model_name;
                document.getElementById('component-description').textContent = data.component_description || data.model_description;
                document.getElementById('component-type').textContent = data.component_type || 'model';
                
                // Update data table if available
                if (data.column_names && data.sample_data && data.sample_data.length > 0) {
                    this.updateDataTable(data.column_names, data.sample_data);
                    document.getElementById('component-data').style.display = 'block';
                }
                
                // Update connections if available
                if (data.connections) {
                    this.updateConnections(data.connections);
                    document.getElementById('component-connections').style.display = 'block';
                }
                
                // Update model info if available
                if (data.model_info) {
                    this.updateModelInfo(data.model_info);
                    document.getElementById('model-info').style.display = 'block';
                }
                
                // Show refresh button
                document.getElementById('refresh-component').style.display = 'inline-block';
            }
            
            updateDataTable(columnNames, sampleData) {
                const tableHeader = document.getElementById('table-header');
                const tableBody = document.getElementById('table-body');
                
                // Clear existing content
                tableHeader.innerHTML = '';
                tableBody.innerHTML = '';
                
                // Add headers
                const headerRow = document.createElement('tr');
                columnNames.forEach(columnName => {
                    const th = document.createElement('th');
                    th.textContent = columnName;
                    headerRow.appendChild(th);
                });
                tableHeader.appendChild(headerRow);
                
                // Add data rows
                sampleData.forEach(row => {
                    const tr = document.createElement('tr');
                    row.forEach(value => {
                        const td = document.createElement('td');
                        td.textContent = value || '';
                        tr.appendChild(td);
                    });
                    tableBody.appendChild(tr);
                });
            }
            
            updateConnections(connections) {
                const incomingList = document.getElementById('incoming-connections');
                const outgoingList = document.getElementById('outgoing-connections');
                
                incomingList.innerHTML = '';
                outgoingList.innerHTML = '';
                
                connections.incoming?.forEach(conn => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${conn.from_display || conn.from}</strong> (${conn.type})`;
                    if (conn.description) {
                        li.innerHTML += `<br><small class="text-muted">${conn.description}</small>`;
                    }
                    incomingList.appendChild(li);
                });
                
                connections.outgoing?.forEach(conn => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${conn.to_display || conn.to}</strong> (${conn.type})`;
                    if (conn.description) {
                        li.innerHTML += `<br><small class="text-muted">${conn.description}</small>`;
                    }
                    outgoingList.appendChild(li);
                });
            }
            
            updateModelInfo(modelInfo) {
                const modelDetails = document.getElementById('model-details');
                modelDetails.innerHTML = '';
                
                if (modelInfo.total_records !== undefined) {
                    const recordCount = document.createElement('p');
                    recordCount.innerHTML = `<strong>Total Records:</strong> ${modelInfo.total_records.toLocaleString()}`;
                    modelDetails.appendChild(recordCount);
                }
                
                if (modelInfo.model_fields) {
                    const fieldsTitle = document.createElement('h6');
                    fieldsTitle.textContent = 'Model Fields:';
                    modelDetails.appendChild(fieldsTitle);
                    
                    const fieldsList = document.createElement('ul');
                    fieldsList.className = 'list-unstyled';
                    
                    modelInfo.model_fields.forEach(field => {
                        const li = document.createElement('li');
                        li.innerHTML = `<code>${field.name}</code> <small class="text-muted">(${field.type})</small>`;
                        if (field.help_text) {
                            li.innerHTML += `<br><small>${field.help_text}</small>`;
                        }
                        fieldsList.appendChild(li);
                    });
                    
                    modelDetails.appendChild(fieldsList);
                }
            }
            
            showModalError(message) {
                document.getElementById('loading-indicator').style.display = 'none';
                document.getElementById('error-text').textContent = message;
                document.getElementById('error-message').style.display = 'block';
            }
        }
        
        // Initialize the diagram when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            new SystemDiagram('system-diagram', '{% url "component_config" %}');
            
            // Set up refresh button handler
            document.getElementById('refresh-component').addEventListener('click', function() {
                // Re-initialize the modal for the current component
                const modal = bootstrap.Modal.getInstance(document.getElementById('componentModal'));
                if (modal) {
                    modal.hide();
                }
            });
        });
    </script>

    <style>
        /* System Diagram Styles */
        #system-diagram-container {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
            padding: 1rem;
            margin: 1rem 0;
            position: relative;
            min-height: 400px;
        }
        
        #system-diagram {
            width: 100%;
            height: auto;
            border: 1px solid #e9ecef;
            border-radius: 0.375rem;
        }
        
        /* Component Styles */
        .component-box, .component-cylinder {
            stroke: #495057;
            stroke-width: 2;
            transition: all 0.3s ease;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
        }
        
        .component-group:hover .component-box,
        .component-group:hover .component-cylinder,
        .component-hover .component-box,
        .component-hover .component-cylinder {
            stroke-width: 3;
            filter: drop-shadow(3px 3px 6px rgba(0,0,0,0.2));
        }
        
        .model-component {
            stroke: #28a745;
        }
        
        .module-component {
            stroke: #fd7e14;
        }
        
        .external-component {
            stroke: #e83e8c;
        }
        
        /* Special styling for database cylinders */
        .component-cylinder.model-component {
            stroke: #28a745;
            stroke-width: 2;
        }
        
        .component-group:hover .component-cylinder.model-component {
            stroke: #1e7e34;
            stroke-width: 3;
        }
        
        .component-text {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 13px;
            font-weight: 600;
            fill: #212529;
            pointer-events: none;
        }
        
        .component-type-text {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 9px;
            font-weight: 400;
            fill: #6c757d;
            pointer-events: none;
        }
        
        /* Connection Styles */
        .connection-line {
            stroke: #6c757d;
            stroke-width: 2;
            fill: none;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        
        .connection-line:hover {
            opacity: 1;
            stroke-width: 3;
        }
        
        /* Loading and Error Overlays */
        .loading-overlay, .error-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Modal Enhancements */
        .component-title {
            color: #495057;
            margin-bottom: 0.5rem;
        }
        
        .component-description {
            color: #6c757d;
            margin-bottom: 1rem;
        }
        
        .component-badges {
            margin-bottom: 1rem;
        }
        
        .component-badges .badge {
            margin-right: 0.5rem;
        }
        
        .connection-list {
            list-style-type: none;
            padding-left: 0;
        }
        
        .connection-list li {
            padding: 0.25rem 0;
            border-bottom: 1px solid #f8f9fa;
        }
        
        .connection-list li:last-child {
            border-bottom: none;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            #system-diagram-container {
                padding: 0.5rem;
            }
            
            .component-text {
                font-size: 10px;
            }
            
            .component-type-text {
                font-size: 7px;
            }
        }
    </style>
{% endblock %}
